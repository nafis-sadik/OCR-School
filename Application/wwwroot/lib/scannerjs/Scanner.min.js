(function () { var e = [], n = null, t = function () { function i(e) { l.debug && (console.log ? console.log(e) : alert(e)) } function s(e) { var n = "http://java.com/dt-redirect"; return null == e || 0 == e.length ? n : ("&" == e.charAt(0) && (e = e.substring(1, e.length)), n + "?" + e) } function r(e) { return function (e, n) { for (var t = e.length, i = 0; t > i; i++)if (e[i] === n) return !0; return !1 }(o, e.toLowerCase()) } var a = { core: ["id", "class", "title", "style"], i18n: ["lang", "dir"], events: ["onclick", "ondblclick", "onmousedown", "onmouseup", "onmouseover", "onmousemove", "onmouseout", "onkeypress", "onkeydown", "onkeyup"], applet: ["codebase", "code", "name", "archive", "object", "width", "height", "alt", "align", "hspace", "vspace"], object: ["classid", "codebase", "codetype", "data", "type", "archive", "declare", "standby", "height", "width", "usemap", "name", "tabindex", "align", "border", "hspace", "vspace"] }, o = (a.object.concat(a.core, a.i18n, a.events), a.applet.concat(a.core)), l = { debug: null, version: "20120801", firefoxJavaVersion: null, myInterval: null, preInstallJREList: null, returnPage: null, brand: null, locale: null, installType: null, EAInstallEnabled: !1, EarlyAccessURL: null, oldMimeType: "application/npruntime-scriptable-plugin;DeploymentToolkit", mimeType: "application/java-deployment-toolkit", launchButtonPNG: function () { var e = "//java.com/js/webstart.png"; try { return -1 != document.location.protocol.indexOf("http") ? e : "http:" + e } catch (n) { return "http:" + e } }(), browserName: null, browserName2: null, getJREs: function () { var e = new Array; if (this.isPluginInstalled()) for (var n = this.getPlugin().jvms, t = 0; t < n.getLength(); t++)e[t] = n.get(t).version; else { var s = this.getBrowser(); "MSIE" == s ? this.testUsingActiveX("1.7.0") ? e[0] = "1.7.0" : this.testUsingActiveX("1.6.0") ? e[0] = "1.6.0" : this.testUsingActiveX("1.5.0") ? e[0] = "1.5.0" : this.testUsingActiveX("1.4.2") ? e[0] = "1.4.2" : this.testForMSVM() && (e[0] = "1.1") : "Netscape Family" == s && (this.getJPIVersionUsingMimeType(), null != this.firefoxJavaVersion ? e[0] = this.firefoxJavaVersion : this.testUsingMimeTypes("1.7") ? e[0] = "1.7.0" : this.testUsingMimeTypes("1.6") ? e[0] = "1.6.0" : this.testUsingMimeTypes("1.5") ? e[0] = "1.5.0" : this.testUsingMimeTypes("1.4.2") ? e[0] = "1.4.2" : "Safari" == this.browserName2 && (this.testUsingPluginsArray("1.7.0") ? e[0] = "1.7.0" : this.testUsingPluginsArray("1.6") ? e[0] = "1.6.0" : this.testUsingPluginsArray("1.5") ? e[0] = "1.5.0" : this.testUsingPluginsArray("1.4.2") && (e[0] = "1.4.2"))) } if (this.debug) for (t = 0; t < e.length; ++t)i("[getJREs()] We claim to have detected Java SE " + e[t]); return e }, installJRE: function (e, n) { if (this.isPluginInstalled() && this.isAutoInstallEnabled(e)) { var t; return (t = this.isCallbackSupported() ? this.getPlugin().installJRE(e, n) : this.getPlugin().installJRE(e)) && (this.refresh(), null != this.returnPage && (document.location = this.returnPage)), t } return this.installLatestJRE() }, isAutoInstallEnabled: function (e) { return !!this.isPluginInstalled() && (void 0 === e && (e = null), function (e) { return "MSIE" != t.browserName || !!t.compareVersionToPattern(t.getPlugin().version, ["10", "0", "0"], !1, !0) || null != e && !function (e, n) { if (null == e || 0 == e.length) return !0; var t = e.charAt(e.length - 1); if ("+" != t && "*" != t && -1 != e.indexOf("_") && "_" != t && (e += "*", t = "*"), (e = e.substring(0, e.length - 1)).length > 0) { var i = e.charAt(e.length - 1); ("." == i || "_" == i) && (e = e.substring(0, e.length - 1)) } return "*" == t ? 0 == n.indexOf(e) : "+" == t && n >= e }("1.6.0_33+", e) }(e)) }, isCallbackSupported: function () { return this.isPluginInstalled() && this.compareVersionToPattern(this.getPlugin().version, ["10", "2", "0"], !1, !0) }, installLatestJRE: function (e) { if (this.isPluginInstalled() && this.isAutoInstallEnabled()) { var n; return (n = this.isCallbackSupported() ? this.getPlugin().installLatestJRE(e) : this.getPlugin().installLatestJRE()) && (this.refresh(), null != this.returnPage && (document.location = this.returnPage)), n } var t = this.getBrowser(), i = navigator.platform.toLowerCase(); return "true" == this.EAInstallEnabled && -1 != i.indexOf("win") && null != this.EarlyAccessURL ? (this.preInstallJREList = this.getJREs(), null != this.returnPage && (this.myInterval = setInterval("deployJava.poll()", 3e3)), location.href = this.EarlyAccessURL, !1) : "MSIE" == t ? this.IEInstall() : "Netscape Family" == t && -1 != i.indexOf("win32") ? this.FFInstall() : (location.href = s((null != this.returnPage ? "&returnPage=" + this.returnPage : "") + (null != this.locale ? "&locale=" + this.locale : "") + (null != this.brand ? "&brand=" + this.brand : "")), !1) }, runApplet: function (e, n, t) { ("undefined" == t || null == t) && (t = "1.1"); var s = t.match("^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:[_\\.](\\d+))?)?)?$"); (null == this.returnPage && (this.returnPage = document.location), null != s) ? "?" != this.getBrowser() ? this.versionCheck(t + "+") ? this.writeAppletTag(e, n) : this.installJRE(t + "+") && (this.refresh(), location.href = document.location, this.writeAppletTag(e, n)) : this.writeAppletTag(e, n) : i("[runApplet()] Invalid minimumVersion argument to runApplet():" + t) }, writeAppletTag: function (e, n) { var t = "<applet ", i = "", s = !0; for (var a in (null == n || "object" != typeof n) && (n = new Object), e) r(a) ? (t += " " + a + '="' + e[a] + '"', "code" == a && (s = !1)) : n[a] = e[a]; var o = !1; for (var l in n) "codebase_lookup" == l && (o = !0), ("object" == l || "java_object" == l || "java_code" == l) && (s = !1), i += '<param name="' + l + '" value="' + n[l] + '"/>'; o || (i += '<param name="codebase_lookup" value="false"/>'), s && (t += ' code="dummy"'), t += ">", document.write(t + "\n" + i + "\n</applet>") }, versionCheck: function (e) { var n = 0, t = e.match("^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:[_\\.](\\d+))?)?)?(\\*|\\+)?$"); if (null != t) { for (var s = !1, r = !1, a = new Array, o = 1; o < t.length; ++o)"string" == typeof t[o] && "" != t[o] && (a[n] = t[o], n++); "+" == a[a.length - 1] ? (r = !0, s = !1, a.length--) : "*" == a[a.length - 1] ? (r = !1, s = !0, a.length--) : a.length < 4 && (r = !1, s = !0); var l = this.getJREs(); for (o = 0; o < l.length; ++o)if (this.compareVersionToPattern(l[o], a, s, r)) return !0; return !1 } var c = "Invalid versionPattern passed to versionCheck: " + e; return i("[versionCheck()] " + c), alert(c), !1 }, isWebStartInstalled: function (e) { if ("?" == this.getBrowser()) return !0; ("undefined" == e || null == e) && (e = "1.4.2"); var n = !1; return null != e.match("^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:[_\\.](\\d+))?)?)?$") ? n = this.versionCheck(e + "+") : (i("[isWebStartInstaller()] Invalid minimumVersion argument to isWebStartInstalled(): " + e), n = this.versionCheck("1.4.2+")), n }, getJPIVersionUsingMimeType: function () { for (var e = 0; e < navigator.mimeTypes.length; ++e) { var n = navigator.mimeTypes[e].type.match(/^application\/x-java-applet;jpi-version=(.*)$/); if (null != n && (this.firefoxJavaVersion = n[1], "Opera" != this.browserName2)) break } }, launchWebStartApplication: function (e) { if (navigator.userAgent.toLowerCase(), this.getJPIVersionUsingMimeType(), 0 == this.isWebStartInstalled("1.7.0") && (0 == this.installJRE("1.7.0+") || 0 == this.isWebStartInstalled("1.7.0"))) return !1; var n = null; document.documentURI && (n = document.documentURI), null == n && (n = document.URL); var t, i = this.getBrowser(); if ("MSIE" == i ? t = '<object classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93" width="0" height="0"><PARAM name="launchjnlp" value="' + e + '"><PARAM name="docbase" value="' + encodeURIComponent(n) + '"></object>' : "Netscape Family" == i && (t = '<embed type="application/x-java-applet;jpi-version=' + this.firefoxJavaVersion + '" width="0" height="0" launchjnlp="' + e + '"docbase="' + encodeURIComponent(n) + '" />'), "undefined" == document.body || null == document.body) document.write(t), document.location = n; else { var s = document.createElement("div"); s.id = "div1", s.style.position = "relative", s.style.left = "-10000px", s.style.margin = "0px auto", s.className = "dynamicDiv", s.innerHTML = t, document.body.appendChild(s) } }, createWebStartLaunchButtonEx: function (e, n) { null == this.returnPage && (this.returnPage = e); var t = "javascript:deployJava.launchWebStartApplication('" + e + "');"; document.write('<a href="' + t + '" onMouseOver="window.status=\'\'; return true;"><img src="' + this.launchButtonPNG + '" border="0" /></a>') }, createWebStartLaunchButton: function (e, n) { null == this.returnPage && (this.returnPage = e); var t = "javascript:if (!deployJava.isWebStartInstalled(&quot;" + n + "&quot;)) {if (deployJava.installLatestJRE()) {if (deployJava.launch(&quot;" + e + "&quot;)) {}}} else {if (deployJava.launch(&quot;" + e + "&quot;)) {}}"; document.write('<a href="' + t + '" onMouseOver="window.status=\'\'; return true;"><img src="' + this.launchButtonPNG + '" border="0" /></a>') }, launch: function (e) { return document.location = e, !0 }, isPluginInstalled: function () { var e = this.getPlugin(); return !(!e || !e.jvms) }, isAutoUpdateEnabled: function () { return !!this.isPluginInstalled() && this.getPlugin().isAutoUpdateEnabled() }, setAutoUpdateEnabled: function () { return !!this.isPluginInstalled() && this.getPlugin().setAutoUpdateEnabled() }, setInstallerType: function (e) { return this.installType = e, !!this.isPluginInstalled() && this.getPlugin().setInstallerType(e) }, setAdditionalPackages: function (e) { return !!this.isPluginInstalled() && this.getPlugin().setAdditionalPackages(e) }, setEarlyAccess: function (e) { this.EAInstallEnabled = e }, isPlugin2: function () { if (this.isPluginInstalled() && this.versionCheck("1.6.0_10+")) try { return this.getPlugin().isPlugin2() } catch (e) { } return !1 }, allowPlugin: function () { return this.getBrowser(), "Safari" != this.browserName2 && "Opera" != this.browserName2 }, getPlugin: function () { this.refresh(); var e = null; return this.allowPlugin() && (e = document.getElementById("deployJavaPlugin")), e }, compareVersionToPattern: function (e, n, t, i) { if (null == e || null == n) return !1; var s = e.match("^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:[_\\.](\\d+))?)?)?$"); if (null != s) { for (var r = 0, a = new Array, o = 1; o < s.length; ++o)"string" == typeof s[o] && "" != s[o] && (a[r] = s[o], r++); var l = Math.min(a.length, n.length); if (i) { for (o = 0; l > o; ++o) { var c = parseInt(a[o]), u = parseInt(n[o]); if (u > c) return !1; if (c > u) return !0 } return !0 } for (o = 0; l > o; ++o)if (a[o] != n[o]) return !1; return !!t || a.length == n.length } return !1 }, getBrowser: function () { if (null == this.browserName) { var e = navigator.userAgent.toLowerCase(); i("[getBrowser()] navigator.userAgent.toLowerCase() -> " + e), -1 != e.indexOf("msie") && -1 == e.indexOf("opera") ? (this.browserName = "MSIE", this.browserName2 = "MSIE") : -1 != e.indexOf("trident") || -1 != e.indexOf("Trident") ? (this.browserName = "MSIE", this.browserName2 = "MSIE") : -1 != e.indexOf("iphone") ? (this.browserName = "Netscape Family", this.browserName2 = "iPhone") : -1 != e.indexOf("firefox") && -1 == e.indexOf("opera") ? (this.browserName = "Netscape Family", this.browserName2 = "Firefox") : -1 != e.indexOf("chrome") ? (this.browserName = "Netscape Family", this.browserName2 = "Chrome") : -1 != e.indexOf("safari") ? (this.browserName = "Netscape Family", this.browserName2 = "Safari") : -1 != e.indexOf("mozilla") && -1 == e.indexOf("opera") ? (this.browserName = "Netscape Family", this.browserName2 = "Other") : -1 != e.indexOf("opera") ? (this.browserName = "Netscape Family", this.browserName2 = "Opera") : (this.browserName = "?", this.browserName2 = "unknown"), i("[getBrowser()] Detected browser name:" + this.browserName + ", " + this.browserName2) } return this.browserName }, testUsingActiveX: function (e) { var n = "JavaWebStart.isInstalled." + e + ".0"; if ("undefined" == typeof ActiveXObject || !ActiveXObject) return i("[testUsingActiveX()] Browser claims to be IE, but no ActiveXObject object?"), !1; try { return null != new ActiveXObject(n) } catch (e) { return !1 } }, testForMSVM: function () { if ("undefined" != typeof oClientCaps) { var e = oClientCaps.getComponentVersion("{08B0E5C0-4FCB-11CF-AAA5-00401C608500}", "ComponentID"); return "" != e && "5,0,5000,0" != e } return !1 }, testUsingMimeTypes: function (e) { if (!navigator.mimeTypes) return i("[testUsingMimeTypes()] Browser claims to be Netscape family, but no mimeTypes[] array?"), !1; for (var t = 0; t < navigator.mimeTypes.length; ++t) { var s = (n = navigator.mimeTypes[t].type).match(/^application\/x-java-applet\x3Bversion=(1\.8|1\.7|1\.6|1\.5|1\.4\.2)$/); if (null != s && this.compareVersions(s[1], e)) return !0 } return !1 }, testUsingPluginsArray: function (e) { if (!navigator.plugins || !navigator.plugins.length) return !1; for (var t = navigator.platform.toLowerCase(), i = 0; i < navigator.plugins.length; ++i)if (-1 != (n = navigator.plugins[i].description).search(/^Java Switchable Plug-in (Cocoa)/)) { if (this.compareVersions("1.5.0", e)) return !0 } else if (-1 != n.search(/^Java/) && -1 != t.indexOf("win") && (this.compareVersions("1.5.0", e) || this.compareVersions("1.6.0", e))) return !0; return !!this.compareVersions("1.5.0", e) }, IEInstall: function () { return location.href = s((null != this.returnPage ? "&returnPage=" + this.returnPage : "") + (null != this.locale ? "&locale=" + this.locale : "") + (null != this.brand ? "&brand=" + this.brand : "")), !1 }, done: function (e, n) { }, FFInstall: function () { return location.href = s((null != this.returnPage ? "&returnPage=" + this.returnPage : "") + (null != this.locale ? "&locale=" + this.locale : "") + (null != this.brand ? "&brand=" + this.brand : "") + (null != this.installType ? "&type=" + this.installType : "")), !1 }, compareVersions: function (e, n) { for (var t = e.split("."), i = n.split("."), s = 0; s < t.length; ++s)t[s] = Number(t[s]); for (s = 0; s < i.length; ++s)i[s] = Number(i[s]); return 2 == t.length && (t[2] = 0), t[0] > i[0] || !(t[0] < i[0]) && (t[1] > i[1] || !(t[1] < i[1]) && (t[2] > i[2] || !(t[2] < i[2]))) }, enableAlerts: function () { this.browserName = null, this.debug = !0 }, poll: function () { this.refresh(); var e = this.getJREs(); 0 == this.preInstallJREList.length && 0 != e.length && (clearInterval(this.myInterval), null != this.returnPage && (location.href = this.returnPage)), 0 != this.preInstallJREList.length && 0 != e.length && this.preInstallJREList[0] != e[0] && (clearInterval(this.myInterval), null != this.returnPage && (location.href = this.returnPage)) }, writePluginTag: function () { var n = this.getBrowser(); if ("MSIE" == n) { e.push({ name: "object", attributes: { id: "deployJavaPlugin", classid: "clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA", width: "0", height: "0" } }) } else "Netscape Family" == n && this.allowPlugin() && this.writeEmbedTag() }, refresh: function () { (navigator.plugins.refresh(!1), "Netscape Family" == this.getBrowser() && this.allowPlugin()) && (null == document.getElementById("deployJavaPlugin") && this.writeEmbedTag()) }, writeEmbedTag: function () { var n = !1; if (null != navigator.mimeTypes) { for (var t = 0; t < navigator.mimeTypes.length; t++)if (navigator.mimeTypes[t].type == this.mimeType && navigator.mimeTypes[t].enabledPlugin) { var i = { name: "embed", attributes: { id: "deployJavaPlugin", type: this.mimeType, hidden: "true" } }; e.push(i), n = !0 } if (!n) for (t = 0; t < navigator.mimeTypes.length; t++)navigator.mimeTypes[t].type == this.oldMimeType && navigator.mimeTypes[t].enabledPlugin && (this.oldMimeType, e.push(this.oldMimeType)) } } }; if (l.writePluginTag(), null == l.locale) { var c = null; if (null == c) try { c = navigator.userLanguage } catch (e) { } if (null == c) try { c = navigator.systemLanguage } catch (e) { } if (null == c) try { c = navigator.language } catch (e) { } null != c && (c.replace("-", "_"), l.locale = c) } return l }(); window.EXT_LIB_DEF_FUNC_BOWSER = function () { function e(e) { function n(n) { var t = e.match(n); return t && t.length > 1 && t[1] || "" } var t, i = n(/(ipod|iphone|ipad)/i).toLowerCase(), s = !/like android/i.test(e) && /android/i.test(e), a = /nexus\s*[0-6]\s*/i.test(e), o = !a && /nexus\s*[0-9]+/i.test(e), l = /CrOS/.test(e), c = /silk/i.test(e), u = /sailfish/i.test(e), d = /tizen/i.test(e), p = /(web|hpw)os/i.test(e), m = /windows phone/i.test(e), f = (/SamsungBrowser/i.test(e), !m && /windows/i.test(e)), h = !i && !c && /macintosh/i.test(e), g = !s && !u && !d && !p && /linux/i.test(e), w = n(/edge\/(\d+(\.\d+)?)/i), v = n(/version\/(\d+(\.\d+)?)/i), b = /tablet/i.test(e) && !/tablet pc/i.test(e), y = !b && /[^-]mobi/i.test(e), _ = /xbox/i.test(e); /opera/i.test(e) ? t = { name: "Opera", opera: r, version: v || n(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i) } : /opr\/|opios/i.test(e) ? t = { name: "Opera", opera: r, version: n(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i) || v } : /SamsungBrowser/i.test(e) ? t = { name: "Samsung Internet for Android", samsungBrowser: r, version: v || n(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i) } : /coast/i.test(e) ? t = { name: "Opera Coast", coast: r, version: v || n(/(?:coast)[\s\/](\d+(\.\d+)?)/i) } : /yabrowser/i.test(e) ? t = { name: "Yandex Browser", yandexbrowser: r, version: v || n(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i) } : /ucbrowser/i.test(e) ? t = { name: "UC Browser", ucbrowser: r, version: n(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i) } : /mxios/i.test(e) ? t = { name: "Maxthon", maxthon: r, version: n(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i) } : /epiphany/i.test(e) ? t = { name: "Epiphany", epiphany: r, version: n(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i) } : /puffin/i.test(e) ? t = { name: "Puffin", puffin: r, version: n(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i) } : /sleipnir/i.test(e) ? t = { name: "Sleipnir", sleipnir: r, version: n(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i) } : /k-meleon/i.test(e) ? t = { name: "K-Meleon", kMeleon: r, version: n(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i) } : m ? (t = { name: "Windows Phone", osname: "Windows Phone", windowsphone: r }, w ? (t.msedge = r, t.version = w) : (t.msie = r, t.version = n(/iemobile\/(\d+(\.\d+)?)/i))) : /msie|trident/i.test(e) ? t = { name: "Internet Explorer", msie: r, version: n(/(?:msie |rv:)(\d+(\.\d+)?)/i) } : l ? t = { name: "Chrome", osname: "Chrome OS", chromeos: r, chromeBook: r, chrome: r, version: n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i) } : /chrome.+? edge/i.test(e) ? t = { name: "Microsoft Edge", msedge: r, version: w } : /vivaldi/i.test(e) ? t = { name: "Vivaldi", vivaldi: r, version: n(/vivaldi\/(\d+(\.\d+)?)/i) || v } : u ? t = { name: "Sailfish", osname: "Sailfish OS", sailfish: r, version: n(/sailfish\s?browser\/(\d+(\.\d+)?)/i) } : /seamonkey\//i.test(e) ? t = { name: "SeaMonkey", seamonkey: r, version: n(/seamonkey\/(\d+(\.\d+)?)/i) } : /firefox|iceweasel|fxios/i.test(e) ? (t = { name: "Firefox", firefox: r, version: n(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i) }, /\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(e) && (t.firefoxos = r, t.osname = "Firefox OS")) : c ? t = { name: "Amazon Silk", silk: r, version: n(/silk\/(\d+(\.\d+)?)/i) } : /phantom/i.test(e) ? t = { name: "PhantomJS", phantom: r, version: n(/phantomjs\/(\d+(\.\d+)?)/i) } : /slimerjs/i.test(e) ? t = { name: "SlimerJS", slimer: r, version: n(/slimerjs\/(\d+(\.\d+)?)/i) } : /blackberry|\bbb\d+/i.test(e) || /rim\stablet/i.test(e) ? t = { name: "BlackBerry", osname: "BlackBerry OS", blackberry: r, version: v || n(/blackberry[\d]+\/(\d+(\.\d+)?)/i) } : p ? (t = { name: "WebOS", osname: "WebOS", webos: r, version: v || n(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i) }, /touchpad\//i.test(e) && (t.touchpad = r)) : /bada/i.test(e) ? t = { name: "Bada", osname: "Bada", bada: r, version: n(/dolfin\/(\d+(\.\d+)?)/i) } : d ? t = { name: "Tizen", osname: "Tizen", tizen: r, version: n(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i) || v } : /qupzilla/i.test(e) ? t = { name: "QupZilla", qupzilla: r, version: n(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i) || v } : /chromium/i.test(e) ? t = { name: "Chromium", chromium: r, version: n(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i) || v } : /chrome|crios|crmo/i.test(e) ? t = { name: "Chrome", chrome: r, version: n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i) } : s ? t = { name: "Android", version: v } : /safari|applewebkit/i.test(e) ? (t = { name: "Safari", safari: r }, v && (t.version = v)) : i ? (t = { name: "iphone" == i ? "iPhone" : "ipad" == i ? "iPad" : "iPod" }, v && (t.version = v)) : t = /googlebot/i.test(e) ? { name: "Googlebot", googlebot: r, version: n(/googlebot\/(\d+(\.\d+))/i) || v } : { name: n(/^(.*)\/(.*) /), version: function (n) { var t = e.match(n); return t && t.length > 1 && t[2] || "" }(/^(.*)\/(.*) /) }, !t.msedge && /(apple)?webkit/i.test(e) ? (/(apple)?webkit\/537\.36/i.test(e) ? (t.name = t.name || "Blink", t.blink = r) : (t.name = t.name || "Webkit", t.webkit = r), !t.version && v && (t.version = v)) : !t.opera && /gecko\//i.test(e) && (t.name = t.name || "Gecko", t.gecko = r, t.version = t.version || n(/gecko\/(\d+(\.\d+)?)/i)), t.windowsphone || t.msedge || !s && !t.silk ? t.windowsphone || t.msedge || !i ? h ? (t.mac = r, t.osname = "macOS") : _ ? (t.xbox = r, t.osname = "Xbox") : f ? (t.windows = r, t.osname = "Windows") : g && (t.linux = r, t.osname = "Linux") : (t[i] = r, t.ios = r, t.osname = "iOS") : (t.android = r, t.osname = "Android"); var E = ""; t.windows ? E = function (e) { switch (e) { case "NT": return "NT"; case "XP": return "XP"; case "NT 5.0": return "2000"; case "NT 5.1": return "XP"; case "NT 5.2": return "2003"; case "NT 6.0": return "Vista"; case "NT 6.1": return "7"; case "NT 6.2": return "8"; case "NT 6.3": return "8.1"; case "NT 10.0": return "10"; default: return } }(n(/Windows ((NT|XP)( \d\d?.\d)?)/i)) : t.windowsphone ? E = n(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i) : t.mac ? E = (E = n(/Mac OS X (\d+([_\.\s]\d+)*)/i)).replace(/[_\s]/g, ".") : i ? E = (E = n(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g, ".") : s ? E = n(/android[ \/-](\d+(\.\d+)*)/i) : t.webos ? E = n(/(?:web|hpw)os\/(\d+(\.\d+)*)/i) : t.blackberry ? E = n(/rim\stablet\sos\s(\d+(\.\d+)*)/i) : t.bada ? E = n(/bada\/(\d+(\.\d+)*)/i) : t.tizen && (E = n(/tizen[\/\s](\d+(\.\d+)*)/i)), E && (t.osversion = E); var S = !t.windows && E.split(".")[0]; return b || o || "ipad" == i || s && (3 == S || S >= 4 && !y) || t.silk ? t.tablet = r : (y || "iphone" == i || "ipod" == i || s || a || t.blackberry || t.webos || t.bada) && (t.mobile = r), t.msedge || t.msie && t.version >= 10 || t.yandexbrowser && t.version >= 15 || t.vivaldi && t.version >= 1 || t.chrome && t.version >= 20 || t.samsungBrowser && t.version >= 4 || t.firefox && t.version >= 20 || t.safari && t.version >= 6 || t.opera && t.version >= 10 || t.ios && t.osversion && t.osversion.split(".")[0] >= 6 || t.blackberry && t.version >= 10.1 || t.chromium && t.version >= 20 ? t.a = r : t.msie && t.version < 10 || t.chrome && t.version < 20 || t.firefox && t.version < 20 || t.safari && t.version < 6 || t.opera && t.version < 10 || t.ios && t.osversion && t.osversion.split(".")[0] < 6 || t.chromium && t.version < 20 ? t.c = r : t.x = r, t } function n(e) { return e.split(".").length } function t(e, n) { var t, i = []; if (Array.prototype.map) return Array.prototype.map.call(e, n); for (t = 0; t < e.length; t++)i.push(n(e[t])); return i } function i(e) { for (var i = Math.max(n(e[0]), n(e[1])), s = t(e, function (e) { var s = i - n(e); return t((e += new Array(s + 1).join(".0")).split("."), function (e) { return new Array(20 - e.length).join("0") + e }).reverse() }); --i >= 0;) { if (s[0][i] > s[1][i]) return 1; if (s[0][i] !== s[1][i]) return -1; if (0 === i) return 0 } } function s(n, t, s) { var r = a; "string" == typeof t && (s = t, t = void 0), void 0 === t && (t = !1), s && (r = e(s)); var o = "" + r.version; for (var l in n) if (n.hasOwnProperty(l) && r[l]) { if ("string" != typeof n[l]) throw new Error("Browser version in the minVersion map should be a string: " + l + ": " + String(n)); return i([o, n[l]]) < 0 } return t } var r = !0, a = e("undefined" != typeof navigator && navigator.userAgent || ""); return a.test = function (e) { for (var n = 0; n < e.length; ++n) { var t = e[n]; if ("string" == typeof t && t in a) return !0 } return !1 }, a.isUnsupportedBrowser = s, a.compareVersions = i, a.check = function (e, n, t) { return !s(e, n, t) }, a._detect = e, a }; var i, s, r, a, o, l, c, u, d, p, m, f, h, g, w, v, b, y, _, E, S, I, j, N, T, x, P, O, A, C, k, R, L, B, M, F = (new Date).getTime() + "-" + Math.floor(1001 * Math.random() + 0); function J(e, n, t, i, s) { this.mimeType = e, this.b = n, this.src = t, this.m = i, this.a = s } function D(e, n) { var t = "scannerjs_" + e; return !(t = window && t in window ? window[t] : void 0) && window && "scannerjs_config" in window && (t = e in window.scannerjs_config ? window.scannerjs_config[e] : void 0), null == t || null == t ? n : t } (i = J.prototype).u = function () { return this.m }, i.v = function () { return this.mimeType }, i.w = function () { return this.b }, i.s = function () { return this.a }, i.h = function () { return "object" == typeof this.a ? this.a.ImageWidth : void 0 }, i.f = function () { return "object" == typeof this.a ? this.a.ImageLength : void 0 }, i.c = function () { return "object" == typeof this.a ? this.a.BitsPerPixel : void 0 }, i.j = function () { return "object" == typeof this.a ? 2 == this.a.PixelType : void 0 }, i.l = function () { return "object" == typeof this.a ? 1 == this.a.PixelType : void 0 }, i.i = function () { return "object" == typeof this.a ? 0 == this.a.PixelType : void 0 }, i.g = function () { return "object" == typeof this.a ? Math.floor(this.a.XResolution) : void 0 }, i.o = function () { if (this.b) return this.b ? le(this.src) : void 0 }, i.toString = function () { var e = ""; this.j() ? e += "Color " : this.l() ? e += "Gray " : this.i() && (e += "Black/white "), e += "image:"; var n = this.h(), t = this.f(), i = this.c(), s = this.g(); return 0 < n && 0 < t && (e += " " + n + " x " + t), 0 < i && (e += " " + i + "-bit"), 0 < s && (e += " @ " + s + " DPI"), e }, r = D("log_level", 0), a = D("java_applet_enabled", !1), o = !1, l = D("scan_app_enabled", !0), c = D("scan_app_download_url", "http://cdn.asprise.com/scanapp/scan-setup.exe"), u = D("scan_app_min_version", "2.04"), d = D("license", "com_asprise_scan_app_license" in window ? window.com_asprise_scan_app_license : null), p = D("skip_load_default_css", !1), m = D("scan_app_port_range_lowest", 9713), f = D("scan_app_port_range_highest", 9716), y = b = v = w = g = h = void 0, _ = [], S = E = void 0, I = D("form_field_name_for_img_objects", "com_asprise_scannerjs_images[]"), j = D("form_field_name_for_img_urls", "com_asprise_scannerjs_images_urls[]"), N = !1, T = D("eager_init", !0), x = null, P = D("display_install_func", void 0), O = D("display_scan_ready_func", void 0), A = D("event_listener", void 0), C = D("sys_response_callback_func", void 0), k = D("reverse_request_handler_func", void 0), R = !1, L = D("additional_css_classes_for_dialogs", ""), B = D("file_name_base", "scanner"), M = function (n) { if (!N || n) { if (n && (r = D("log_level", 0), m = D("scan_app_port_range_lowest", 9713), f = D("scan_app_port_range_highest", 9716), P = D("display_install_func", void 0), O = D("display_scan_ready_func", void 0), A = D("event_listener", void 0), C = D("sys_response_callback_func", void 0), k = D("reverse_request_handler_func", void 0), K = D("max_conn_attempts", -1)), x = new Date, A && A("pre-init"), D("skip_fix_formdata_append", !1) || s || (s = window.FormData.prototype.append, window.FormData.prototype.append = function (e, n, t) { n instanceof Blob && null == t ? s.apply(this, [e, n, n.name]) : s.apply(this, arguments) }), me("Initializing Scanner.js v2.11.3 © Asprise ..."), p || function () { for (var e = !1, n = document.getElementsByTagName("link"), t = 0; t < n.length; t++) { var i = n.item(t), s = new RegExp(B + "\\.css(\\?\\w*)?$"); i.href && i.href.match(s) && (e = !0) } e || (e = ee() + B + ".css", (n = document.createElement("link")).setAttribute("rel", "stylesheet"), n.setAttribute("type", "text/css"), n.setAttribute("href", e), document.getElementsByTagName("head")[0].appendChild(n)) }(), a && de()) { (n = window.location.href) && 0 > n.toLowerCase().indexOf("http:") && 0 > n.toLowerCase().indexOf("https:") && (me("The scan applet does *NOT* work in local HTML files. Please host this page on localhost or any other servers and access it using http:// or https://.", !0), alert("The scan applet does *NOT* work in local HTML files. Please host this page on localhost or any other servers and access it using http:// or https://.")), me("Attempt to enable Java applet for scanning ..."), me(ge.name + " " + ge.version + " supports NPAPI? " + de()), function () { if (0 != e.length) { var n = document.getElementsByTagName("body"); if (null == (n = null != n && 0 < n.length ? n.item(0) : null)) fe("Unexcepted error - unable to get body"); else for (var t = 0; t < e.length; t++)n.appendChild(pe(e[t])) } }(); try { !function () { var e; (e = ee()) || (e = "https://cdn.asprise.com/scannerjs/"), -1 < e.indexOf("FORCE_REFRESH") && -1 < window.location.href.indexOf("FORCE_REFRESH") && (e = e.replace(/FORCE_REFRESH/g, "FORCE_REFRESH_" + (new Date).getTime())); var n = document.getElementById("com_asprise_scan_applet"); null == n && (n = he.versionCheck("1.7.0_45+") ? "asprise_scan.jar" : "asprise_scan-legacy.jar", n = pe({ name: "applet", attributes: { id: "com_asprise_scan_applet", codebase: e, archive: n, code: "com.asprise.imaging.scan.ui.web.ScanApplet", width: 1, height: 1, style: "z-index: -999;" }, children: [{ name: "param", attributes: { name: "permissions", value: "all-permissions" } }, { name: "param", attributes: { name: "java_version", value: "1.6+" } }, { name: "param", attributes: { name: "java_arguments", value: "-Xmx512m" } }, { name: "param", attributes: { name: "separate_jvm", value: "true" } }, { name: "param", attributes: { name: "codebase_lookup", value: "false" } }, { name: "param", attributes: { name: "mayscript", value: "mayscript" } }] }), null == (e = null != (e = document.getElementsByTagName("body")) && 0 < e.length ? e.item(0) : null) ? fe('please do not execute com_asprise_scan_addScanAppletToDomIfNotExists in <header>. document.getElementsByTagName("body").length = ' + document.getElementsByTagName("body").length) : e.appendChild(n)) }() } catch (e) { me("Failed to add applet element: " + e, !0) } l && oe() && (!ue() || ge.firefox ? window.setTimeout(function () { R || (me("Java applet doesn't seem running. Falling back to scan app ..."), Q()) }, 1e3) : me("JRE: " + he.getJREs())) } else a && !de() && me("The scanning Java applet is set to on, but this browser doesn't support NPAPI: " + ge.name + " " + ge.version, !0), Q(); me("Scanner.js initialized."), N = !0, A && A("post-init") } }; var U = null; function W(e, n, t, i, s, r, l, c, u, d) { if (G() || o || "scan" != n && "listSources" != n && "getSource" != n && "getSystemInfo" != n || (U = arguments), !G() && !o) return a && de() ? null != x && 1e4 < (new Date).getTime() - x.getTime() && ne(!0) : ne(!0), !1; if (2 > arguments.length) return fe("Invalid function call - func name is not specified"), !1; if ("function" != typeof e) return fe("asprise_scanner_js_call_function requires a valid callbackFunc"), !1; if ("PENDING" == y || "PROCESSING" == y) return fe("You can not submit a new request as the previous request has not completed yet."), !1; if (!JSON || "function" != typeof JSON.stringify) return fe("JSON.stringify is not supported by your browser."), !1; for (var p = { funcCallId: (new Date).getTime() + "-" + Math.floor(1e4 * Math.random()), funcName: n, time: (new Date).getTime(), userAgent: navigator.userAgent, isModernBrowser: oe(), windowTitle: document.title, url: window.location.href, pageLoadId: ce() }, m = [], f = 2; f < arguments.length; f++)m.push(arguments[f]); return p.funcArgs = m, p = JSON.stringify(p), y = "PENDING", E = p, S = e, A && A("func-call", p), z(), !0 } function V() { if ("PENDING" == y || "PROCESSING" == y) { var e = JSON.parse(E); _.push(e), me("Canceled func call: " + e.funcName + ", call id: " + e.funcCallId), A && A("func-cancelled", e) } y = void 0 } function z() { if (G() && "PENDING" == y) try { g.send(E), y = "PROCESSING" } catch (e) { q(!1, "Failed: " + e, null, null, null, null, null), me(e, !0) } } function q(e, n, t, i, s, r, a) { if (null != s && 1 != s && fe("resultCount should be null or 1, actual: " + s), a) for (t = 0; t < _.length; t++)if (null != (i = _[t]) && i.funcCallId == a) return void me("Response is ignored for cancelled func call: " + i.funcName + ", call id: " + i.funcCallId + ":\n" + r); if (y = "COMPLETE", S(e, n, r), A) try { A("func-return") } catch (e) { me("Exception occurred in event handler: " + e, !0) } try { window.focus() } catch (e) { } } function X(e) { !function (e) { var n = null; if ("string" == typeof e && 6 < e.length && "<error" == e.substr(0, 6)) throw e; if (e && 7 < e.length && "SYSTEM/" == e.substr(0, 7)) try { var t = e.indexOf(":"); if (0 < t && "NET" == e.substr(7, 3)) { var i = e.substr(0, t); re(e.substr(t + 1).trim().split("|"), function (e, n) { try { g.send(i + ":" + JSON.stringify({ success: e, data: n })) } catch (e) { me("Failed to send command: " + e, !0) } }) } else C && (0 < t ? C(e.substr(0, t), e.substr(t + 1)) : fe("Invalid system response: " + e)) } catch (e) { me("Error while processing system request: " + e, !0) } else if (e && 3 < e.length && "RR:" == e.substr(0, 3)) try { var s = JSON.parse(e.substr(3)), r = s.rr_id, a = s.func, o = s.args; k ? k(a, o, function (e, n) { try { g.send("RR_RESULT:" + JSON.stringify({ rr_id: r, result: { result: e, error: n } })) } catch (e) { me("Failed to send response to scan app: " + e, !0) } }) : g.send("RR_RESULT:" + JSON.stringify({ rr_id: r, result: { result: null, error: "reverseRequestHandlerFunc is not set" } })) } catch (e) { me("Error while processing RR: " + e, !0) } else { try { n = JSON.parse(e) } catch (n) { return fe("Failed to parse JSON: " + e), void q(!1, "Failed to parse JSON: " + e, null, null, null, null, null) } n instanceof Array ? q(n[0], n[1], n[2], n[3], n[4], 5 < n.length ? n[5] : null, 6 < n.length ? n[6] : null) : q(!1, "JSON returned from WebSocket is not array", null, null, null, null, null) } }(e.data) } function G() { return null != g } function H(e) { R = !0, V(), ne(!1), "function" == typeof O && O(), A && A("ready", e), U && 2 <= U.length && W.apply(null, Array.prototype.slice.call(U)) } function Y(e) { me("Scan WebSocket server connected: " + (g = e).url), d && e.send("LICENSE: " + d), u && e.send("MIN_VERSION: " + u), H(!0), z() } function $() { g = void 0, Q(!0) } var Z = 0, K = D("max_conn_attempts", -1); function Q(e) { if (l) if (g) w = void 0, g.close(); else { e || (h = void 0, Z += 1); var n = 3 < (e = null != window.location.href && "http:" == window.location.href.substr(0, 5) ? "ws://127.0.0.1" : "wss://local.scannerjs.com").length && "wss" == e.substr(0, 3).toLowerCase(); if (null == h ? h = m : null != w && 1e4 > (new Date).getTime() - w && (h += 1), h % 2 != (n ? 0 : 1) && (h += 1), h < m || h > f) me("Failed to connect to WebSocket server.", !0), A && A("failed-to-connect"), de(), !(0 < (K = D("max_conn_attempts", -1))) || Z < K ? Q() : (Z = 0, A && A("failed-to-connect-final")); else { w = (new Date).getTime(); try { n = ae; var t = e + ":" + h + "/" + ce() + "/", i = window.location.href; if (null == i) var s = i; else { var r = i.indexOf("#"); s = 0 <= r ? i.substr(0, r) : i } n(t + encodeURIComponent(s)) } catch (e) { A && A("disconnected", e), $() } } } else fe("Scan app implementation is disabled explicitly.") } function ee() { for (var e = document.getElementsByTagName("script"), n = 0; n < e.length; n++) { var t = e.item(n), i = new RegExp(B + "\\.js(\\?\\w*)?$"); if (t.src && t.src.match(i)) return (e = t.src).substring(0, e.lastIndexOf("/") + 1) } return "https://cdn.asprise.com/scannerjs/" } function ne(e) { ("function" != typeof P || P(e)) && (N ? te(e) : (M(!1), e || te(e))) } function te(e) { var n = document.getElementById("asprise-web-scan-setup-dialog-wrapper"); if (e || n) { if (!n) { n = { name: "div", attributes: { id: "asprise-web-scan-setup-dialog-wrapper", class: "asprise-web-scan-dialog-wrapper " + L }, children: [{ name: "div", attributes: { id: "asprise-web-scan-setup-dialog-overlay", class: "overlay asprise-web-scan-dialog-display", style: "display: none" } }, { name: "div", attributes: { id: "asprise-web-scan-setup-dialog", class: "asprise-web-scan-dialog asprise-web-scan-dialog-display", style: "display: none" }, children: [{ name: "button", attributes: { class: "top-right-closer", title: "Dismiss this dialog" } }, { name: "div", attributes: { class: "asprise-web-scan-setup", style: "margin: auto" }, children: [{ name: "h2", attributes: { text: "Please complete one-time setup" } }, { name: "table", attributes: { class: "asprise-web-scan-setup-instruction" }, children: [{ name: "tr", attributes: { class: "icon" }, children: [{ name: "td", attributes: { width: "33%", class: "download" } }, { name: "td", attributes: { width: "33%", class: "run" } }, { name: "td", attributes: { width: "33%", class: "enjoy" } }] }, { name: "tr", attributes: { class: "after_icon" }, children: [{ name: "td", attributes: { colspan: "3" } }] }, { name: "tr", attributes: { class: "text" }, children: [{ name: "td", attributes: { class: "download" }, children: [{ name: "h3", children: [{ name: "a", attributes: { href: c, target: "_blank", text: "Download" } }] }, { name: "p", children: [{ name: "a", attributes: { class: "underline", href: c, target: "_blank", title: "One time setup executable", text: "Download the setup" } }, { name: "span", attributes: { text: ";" } }, { name: "br" }, { name: "span", attributes: { style: "font-size: smaller", text: "Other formats: " } }, { name: "a", attributes: { style: "font-size: smaller", class: "underline", href: c.substr(0, c.lastIndexOf(".")) + ".zip", target: "_blank", title: "Zip format", text: "zip" } }, { name: "span", attributes: { style: "font-size: smaller", text: " · " } }, { name: "a", attributes: { style: "font-size: smaller", class: "underline", href: c.substr(0, c.lastIndexOf(".")) + ".7z", target: "_blank", title: "7Z format", text: "7z" } }] }] }, { name: "td", attributes: { class: "run" }, children: [{ name: "h3", attributes: { text: "Run" } }, { name: "p", attributes: { text: "Run the setup, follow the instruction;" } }] }, { name: "td", attributes: { class: "enjoy" }, children: [{ name: "h3", attributes: { text: "Scan" } }, { name: "p", attributes: { text: "Viola you're ready to scan!" } }] }] }] }, { name: "p", children: [{ name: "span", attributes: { text: "Already have the scan app set up? " } }, { name: "a", attributes: { class: "underline", href: "AspriseWebScan://browser", target: "_top", text: "Click here to enable it." } }] }] }] }, { name: "div", attributes: { id: "asprise-web-scan-setup-ok-dialog", class: "asprise-web-scan-dialog small-dialog asprise-web-scan-setup-ok-dialog", style: "display: none" }, children: [{ name: "button", attributes: { class: "top-right-closer", title: "Dismiss this dialog" } }, { name: "div", attributes: { class: "asprise-web-scan-setup-ok" }, children: [{ name: "div", attributes: { class: "icon" } }, { name: "div", children: [{ name: "p", attributes: { text: "All set. You may scan now." } }] }] }] }] }; var t = document.getElementsByTagName("body"); if (null == (t = null != t && 0 < t.length ? t.item(0) : null)) return fe("please do not execute displaySetupDialog in <header>!"), !1; if (t.appendChild(pe(n)), n = document.getElementById("asprise-web-scan-setup-dialog-wrapper")) { t = n.getElementsByClassName("top-right-closer"); for (var i = 0; t && i < t.length; ++i)t[i].addEventListener("click", function () { this.parentElement.previousElementSibling.style.display = "none", this.parentElement.style.display = "none" }) } } e ? ie(n, ".asprise-web-scan-dialog-display", "display", "block") : (G() ? (ie(n, ".asprise-web-scan-setup-ok-dialog", "display", "block"), ie(n, ".asprise-web-scan-setup-ok-dialog", "opacity", "1"), se(n.querySelectorAll(".asprise-web-scan-setup-ok-dialog"), 2500)) : ie(n, ".asprise-web-scan-setup-ok-dialog", "display", "none"), ie(n, ".asprise-web-scan-dialog-display", "display", "none")) } } function ie(e, n, t, i) { for (e = e.querySelectorAll(n), n = 0; e && n < e.length; n++)e[n].style[t] = i } function se(e, n) { if (null != e && 0 != e.length) if (0 < n) setTimeout(function () { se(e) }, n); else var t = 1, i = setInterval(function () { if (0 >= t) { clearInterval(i); for (var n = 0; n < e.length; n++)e.item(n).style.display = "none" } else { for (n = 0; n < e.length; n++)e.item(n).style.opacity = t.toFixed(1); t -= .1 } }, 50) } function re(e, n) { if (!Array.isArray(e)) throw "Expecting an Array, actual: " + e; if (0 == e.length) n(!1, null); else { var t = e[0]; e.splice(0, 1); var i = new XMLHttpRequest; i.open("GET", t, !0), i.onreadystatechange = function () { i.readyState === XMLHttpRequest.DONE && (200 <= i.status && 300 > i.status ? n(!0, i.responseText) : (me("Failed to " + t + ": " + i.statusText, !0), re(e, n))) }, i.send() } } function ae(e) { if ("WebSocket" in window) var n = new WebSocket(e); else { if (!("MozWebSocket" in window)) return; n = new MozWebSocket(e) } n.onopen = function () { Y(n) }, n.onclose = function (e) { v = e, $() }, n.onmessage = function (e) { X(e) }, n.onerror = function (e) { b = e, me("WebSocket [" + n.url + "] error occurs:" + JSON.stringify(e)) }, A && A("disconnected", void 0) } function oe() { return "function" == typeof atob && "function" == typeof ArrayBuffer && "function" == typeof Uint8Array && "function" == typeof Blob && "function" == typeof FormData } function le(e, n) { if (!oe()) return fe("base64ToBlob() is not supported in legacy browsers."), null; if (null != e && 0 == e.indexOf("data:")) { var t = e.indexOf(";"); !n && 0 < t && (n = e.substring(5, t)), 0 < (t = e.indexOf("base64,")) && (e = e.substr(t + 7)) } e = e.replace(/(\r\n|\n|\r)/gm, ""), t = (e = atob(e)).length; var i = new ArrayBuffer(t); i = new Uint8Array(i); for (var s = 0; s < t; s++)i[s] = e.charCodeAt(s); if (e = new Blob([i], { type: n }), !r) { var r = [(t = new Date).getFullYear(), t.getMonth() + 1, t.getDate(), t.getHours(), t.getMinutes(), t.getSeconds()]; for (r = (2e3 < r[0] ? r[0] - 2e3 : r[0]) + (10 > r[1] ? "0" : "") + r[1] + (10 > r[2] ? "0" : "") + r[2] + (10 > r[3] ? "0" : "") + r[3] + (10 > r[4] ? "0" : "") + r[4] + (10 > r[5] ? "0" : "") + r[5], t = t.getMilliseconds(), i = 1, s = 0; 2 > s; s++)i *= 10; for (i = "" + (Math.floor(Math.random() * (i - 0 + 1)) + 0); 2 > i.length;)i = "0" + i; r = (r = r + (100 > t ? (10 > t ? "0" : "") + "0" : "") + t + i) + "." + (null == n ? "unknown" : 0 <= n.toLowerCase().indexOf("bmp") ? "bmp" : 0 <= n.toLowerCase().indexOf("png") ? "png" : 0 <= n.toLowerCase().indexOf("jp") ? "jpg" : 0 <= n.toLowerCase().indexOf("tif") ? "tif" : 0 <= n.toLowerCase().indexOf("pdf") ? "pdf" : "unknown") } if (r) try { e.lastModifiedDate = new Date, e.name = r } catch (e) { } return e } function ce() { return window.sessionStorage && (sessionStorage.getItem("pageLoadId") ? F = sessionStorage.getItem("pageLoadId") : sessionStorage.setItem("pageLoadId", F)), F } function ue() { var e = he.getJREs(); return !(null == e || "" == e || e instanceof Array && 0 == e.length) } function de() { if (!("version" in ge)) return fe("Invalid bowser"), !1; var e = Math.floor(ge.version); return ge.chrome ? 45 > e : ge.firefox ? 53 > e : !ge.msedge && !!ge.msie } function pe(e) { var n = e.attributes, t = document.createElement(e.name); if (null != n) for (var i in n) t.setAttribute(i, n[i]); if ((n = null != n && "text" in n ? n.text : void 0) && t.appendChild(document.createTextNode(n)), e.children instanceof Array) for (e = e.children, n = 0; n < e.length; n++)e[n] && t.appendChild(pe(e[n])); return t } function me(e, n) { if (!(r > (n ? 16 : 4))) if (window.console) { var t = (new Date).toLocaleTimeString(); n ? console.error ? console.error(t + " " + e) : console.log(t + " ERROR: " + e) : console.info ? console.info(t + " " + e) : console.log(t + " INFO: " + e) } else n && window.alert && alert("ERROR: " + e) } function fe(e) { me(e, !0) } var he = t; var ge = window.EXT_LIB_DEF_FUNC_BOWSER(); delete window.EXT_LIB_DEF_FUNC_BOWSER, window.scannerjs = window.scannerjs || {}, window.scannerjs.webSocketSend = function (e) { return g.send(e) }, window.scannerjs.getWebSocket = function () { return g }, window.scannerjs.getWebSocketLastErrorEvent = function () { return b }, window.scannerjs.getWebSocketLastCloseEvent = function () { return v }, window.scannerjs.doesCurrentBrowserSupportNPAPI = de, window.scannerjs.onAppletStarted = function (e) { o = !0, me("Applet started: " + e), H(!1) }, window.scannerjs.getRequestFuncCall = function () { return E }, window.scannerjs.functionReturn = q, window.scannerjs.getRequestStatus = function () { return y }, window.scannerjs.setRequestStatus = function (e) { return y = e }, window.scannerjs.callFunction = W, window.scannerjs.scan = function (e, n, t, i) { return "string" == typeof n || JSON && "function" == typeof JSON.stringify ? W(e, "scan", "string" == typeof n ? n : JSON.stringify(n), 3 <= arguments.length ? t : null, 4 <= arguments.length ? i : null) : (fe("JSON.stringify is not supported by your browser."), !1) }, window.scannerjs.listSources = function (e, n, t, i, s, r) { return W(e, "listSources", !(2 <= arguments.length) || n, 3 <= arguments.length ? t : null, 4 <= arguments.length && i, !(5 <= arguments.length) || s, 6 <= arguments.length && null != r ? "string" == typeof r ? r : JSON.stringify(r) : "") }, window.scannerjs.getSource = function (e, n, t, i, s, r, a, o) { return W(e, "getSource", 2 <= arguments.length ? n : "select", !(3 <= arguments.length) || t, 4 <= arguments.length ? i : null, !(5 <= arguments.length) || s, 6 <= arguments.length && r, 7 <= arguments.length ? a : null, 8 <= arguments.length && null != o ? "string" == typeof o ? o : JSON.stringify(o) : "") }, window.scannerjs.getSystemInfo = function (e) { return W(e, "asprise_scan_system_info") }, window.scannerjs.initialize = M, window.scannerjs.getScannedImages = function (e, n, t) { var i = []; if (2 > arguments.length && (n = !0), 3 > arguments.length && (t = !1), !n && !t) return fe("getImages: will return no image as neither includeOriginals nor includeThumbnails is true."), i; if ("string" == typeof e) { if (6 < e.length && "<error" == e.substr(0, 6)) throw e; try { e = JSON.parse(e) } catch (n) { throw e } } if ("object" == typeof e && e.output instanceof Array) for (var s = e.output, r = 0; r < s.length; r++) { var a = s[r]; if (n && "return-base64" == a.type || t && "return-base64-thumbnail" == a.type) { var o = a.format; if ("application/octet-stream" == (o = null == o ? "application/octet-stream" : 0 <= o.toLowerCase().indexOf("bmp") ? "image/bmp" : 0 <= o.toLowerCase().indexOf("png") ? "image/png" : 0 <= o.toLowerCase().indexOf("jp") ? "image/jpeg" : 0 <= o.toLowerCase().indexOf("tif") ? "image/tiff" : 0 <= o.toLowerCase().indexOf("pdf") ? "application/pdf" : "application/octet-stream")) me("Unable to find mime type for " + a.format); else if (a.result instanceof Array) for (var l = 0; l < a.result.length; l++) { var c = e.images instanceof Array && l < e.images.length ? e.images[l] : null; i.push(new J(o, !0, "data:" + o + ";base64," + a.result[l], c, c ? c.image_info : void 0, a.hasOwnProperty("selected_action") ? a.selected_action : void 0, a.hasOwnProperty("selected_filename") ? a.selected_filename : void 0)) } else me("Output contains no result records", !0) } } return i }, window.scannerjs.getUploadResponse = function (e) { if ("string" == typeof e) { if (6 < e.length && "<error" == e.substr(0, 6)) throw e; try { e = JSON.parse(e) } catch (n) { throw e } } if ("object" == typeof e && e.output instanceof Array) { e = e.output; for (var n = 0; n < e.length; n++) { var t = e[n]; if (("upload" == t.type || "upload-thumbnail" == t.type) && t.result instanceof Array && 0 < t.result.length) return t.result[0] } } }, window.scannerjs.getSaveResponse = function (e) { if ("string" == typeof e) { if (6 < e.length && "<error" == e.substr(0, 6)) throw e; try { e = JSON.parse(e) } catch (n) { throw e } } if ("object" == typeof e && e.output instanceof Array) { e = e.output; for (var n = 0; n < e.length; n++) { var t = e[n]; if ("save" == t.type || "save-thumbnail" == t.type) return JSON.stringify(t.result) } } }, window.scannerjs.createDomElementFromModel = pe, window.scannerjs.submitFormWithImages = function (e, n, t) { if (n instanceof Array && 0 != n.length) { for (var i = 0; i < n.length; i++) { var s = n[i]; if (!(s instanceof J)) return me("Invalid image object: " + s, !0), void fe("Invalid image object!") } var r = document.getElementById(e); if (null != r) { for (e = new FormData(r), i = 0; i < n.length; i++)(s = n[i]).b ? e.append(I, le(s.src, s.mimeType)) : e.append(j, s.src); me("POST images, count: " + n.length); var a = new XMLHttpRequest; return a.open("POST", r.getAttribute("action"), !0), a.onreadystatechange = function () { "function" == typeof t && t(a) }, a.send(e), me("Form posted: " + a), a } fe("Form doesn't exist: " + e) } else fe("no images - form submit cancelled.") }, window.scannerjs.getScannerJsConfig = D, window.scannerjs.cancelFuncCalls = V, window.scannerjs.logToConsole = me, window.scannerjs.base64ToUint8Array = function (e) { if (!oe()) return fe("base64ToBlob() is not supported in legacy browsers."), null; if (null != e && 0 == e.indexOf("data:")) { var n = e.indexOf("base64,"); 0 < n && (e = e.substr(n + 7)) } e = e.replace(/(\r\n|\n|\r)/gm, ""), n = (e = atob(e)).length; var t = new ArrayBuffer(n); t = new Uint8Array(t); for (var i = 0; i < n; i++)t[i] = e.charCodeAt(i); return t }, window.scannerjs.fadeOut = se, window.scannerjs.hasJava = ue, window.scannerjs.hasWebSocketSupport = function () { var e = "WebSocket" in window && null != window.WebSocket || "MozWebSocket" in window; return e || fe("WebSocket is not supported by this browser: " + ge.name + " " + ge.version), e }, window.scannerjs.isWindows = function () { if ("navigator" in window && null != window.navigator && "platform" in window.navigator) return -1 < navigator.platform.indexOf("Win") }, window.scannerjs.isHttps = function () { return "https:" == document.location.protocol }, window.scannerjs.version = "2.11.3", window.scannerjs.MIME_TYPE_BINARY = "application/octet-stream", window.scannerjs.MIME_TYPE_BMP = "image/bmp", window.scannerjs.MIME_TYPE_GIF = "image/png", window.scannerjs.MIME_TYPE_JPEG = "image/jpeg", window.scannerjs.MIME_TYPE_PNG = "image/tiff", window.scannerjs.MIME_TYPE_PDF = "application/pdf", window.scannerjs.EVENT_LOADED = "loaded", window.scannerjs.EVENT_PRE_INIT = "pre-init", window.scannerjs.EVENT_POST_INT = "post-init", window.scannerjs.EVENT_FUNC_CALL = "func-call", window.scannerjs.EVENT_FUNC_CANCELLED = "func-cancelled", window.scannerjs.EVENT_FUNC_RETURN = "func-return", window.scannerjs.EVENT_READY = "ready", window.scannerjs.EVENT_FAILED_TO_CONNECT = "failed-to-connect", window.scannerjs.EVENT_FAILED_TO_CONNECT_FINAL = "failed-to-connect-final", window.scannerjs.EVENT_DISCONNECTED = "disconnected", window.scannerjs.LOG_LEVEL_INFO = 4, window.scannerjs.LOG_LEVEL_ERROR = 16, window.scannerjs.LOG_LEVEL_ALL = 0, window.scannerjs.LOG_LEVEL_OFF = 1024, window.scannerjs.getIsInitialized = function () { return N }, window.scannerjs.getIsReady = function () { return R }, window.scannerjs.isConnectedToScanWebSocket = G, window.scannerjs.displaySetupDialog = te, window.scannerjs.doAjax = re, window.scannerjs.ScannedImage = J, window.scannerjs.ScannedImage.prototype.getMimeType = J.prototype.v, window.scannerjs.ScannedImage.prototype.getSrcIsBase64 = J.prototype.w, window.scannerjs.ScannedImage.prototype.getImageInfo = J.prototype.s, window.scannerjs.ScannedImage.prototype.getInfo = J.prototype.u, window.scannerjs.ScannedImage.prototype.getWidth = J.prototype.h, window.scannerjs.ScannedImage.prototype.getHeight = J.prototype.f, window.scannerjs.ScannedImage.prototype.isColor = J.prototype.j, window.scannerjs.ScannedImage.prototype.isGray = J.prototype.l, window.scannerjs.ScannedImage.prototype.isBlackWhite = J.prototype.i, window.scannerjs.ScannedImage.prototype.getResolution = J.prototype.g, window.scannerjs.ScannedImage.prototype.getBitsPerPixel = J.prototype.c, window.scannerjs.ScannedImage.prototype.getBase64NoPrefix = J.prototype.o, window.scannerjs.ScannedImage.prototype.toString = J.prototype.toString, "scanner" in window || (window.scanner = window.scannerjs), "ScannedImage" in window || (window.ScannedImage = window.scannerjs.ScannedImage), window && (window.addEventListener ? window.addEventListener("load", function () { T && M(!1) }) : window.attachEvent && window.attachEvent("onload", function () { T && M(!1) })); try { A && A("loaded") } catch (e) { } }).call(window);